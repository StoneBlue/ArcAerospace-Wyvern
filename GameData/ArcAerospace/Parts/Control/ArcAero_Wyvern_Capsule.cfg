PART
{
	name = ArcAero_Wyvern_Capsule  //  WyvernCrewCapsule
	module = Part
	author = Jon Ross, modified by Stone Blue

	MODEL
	{
		model = ArcAerospace/Assets/Capsule/ArcAero_Wyvern_Capsule
	}
	rescaleFactor = 1

	node_stack_bottom = 0.0, -0.63, 0.0, 0.0, -1.0, 0.0, 2
	node_stack_top =    0.0,  1.40, 0.0, 0.0,  1.0, 0.0, 1
	attachRules = 1,0,1,1,0

	TechRequired = commandModules
	entryCost = 20500
	cost = 7200
	category = Pods
	subcategory = 0
	title = Wyvern Crew Capsule
	manufacturer = Arc Aerospace
	description = This modern crew capsule comes from the fledgling startup Arc Aerospace after only three years of development. The advanced composite construction means this pod is only slightly heavier than the Mk1-3 pod while capable of carrying two more astronauts.\n\nThese breakthroughs have allowed Arc Aerospace to dramatically increase the amount of electric charge storage and improve data transmission and data relay capabilities.

	mass = 3.2
	dragModelType = default
	maximum_drag = 0.20
	minimum_drag = 0.15
	angularDrag = 2
	crashTolerance = 20
	maxTemp = 1400
	skinMaxTemp = 2400
	bulkheadProfiles = size2, size1
	tags = #autoLOC_501807   //#autoLOC_501807 = capsule cmg control ?eva fly gyro ?iva moment pilot react rocket space stab steer torque
	vesselType = Ship
	CrewCapacity = 5

	CoMOffset = 0.0, -0.2, 0.0
	CoPOffset = 0.0,  1.1, 0.0
	CoLOffset = 0.0,  0.6, 0.0
	CenterOfBuoyancy = 0.0, 0.2, 0.0
	CenterOfDisplacement = 0.0, 0.0, 0.0
	buoyancyUseSine = False
	buoyancy = 1.05
	bodyLiftOnlyUnattachedLift = True
	bodyLiftOnlyAttachName = bottom
	skinInternalConductionMult = 0.625
	heatConductivity = 0.1 // 5/6ths default
	INTERNAL
	{
		name = ArcAero_Wyvern_IVA  //  WyvernCrewCapsuleInterior  //WyvernCommandPodInterior
	}

	//  Model Specific Nodes

	MODULE
	{
		name = FlagDecal
		textureQuadName = flagTransform
	}
	
	MODULE
	{
		name = ModuleColorChanger
		materialsNames = ArcAero_Wyvern_Windows
		useMaterialsList = true
		shaderProperty = _EmissiveColor
		animRate = 0.8
		animState = false
		useRate = true
		toggleInEditor = true
		toggleInFlight = true
		toggleInFlight = true
		unfocusedRange = 5
		toggleName = #autoLOC_502011 //#autoLOC_502011 = Toggle Lights
		eventOnName = #autoLOC_502012 //#autoLOC_502012 = Lights On
		eventOffName = #autoLOC_502013 //#autoLOC_502013 = Lights Off
		toggleAction = True
		defaultActionGroup = Light
		redCurve
		{
			key = 0 0 0 3
			key = 1 1 0 0
		}
		greenCurve
		{
			key = 0 0 0 1
			key = 1 1 1 0
		}
		blueCurve
		{
			key = 0 0 0 0
			key = 1 0.7 1.5 0
		}
		alphaCurve
		{
			key = 0 1
		}
	}

	//  Command Pod Specific Nodes

	MODULE
	{
		name = ModuleCommand
		minimumCrew = 1
		defaultControlPointDisplayName = #autoLOC_6011003 //#autoLOC_6011003 = Default
		CONTROLPOINT
		{
			name = reverse
			displayName = #autoLOC_6011004 //#autoLOC_6011004 = Reversed
			orientation = 0,0,180
		}
	}
	
	MODULE
	{
		name = ModuleProbeControlPoint
		minimumCrew = 2
		multiHop = False
	}

	//  Physics/Control Specific Nodes

	MODULE
	{
		name = ModuleReactionWheel
		PitchTorque = 20
		YawTorque = 20
		RollTorque = 20
		RESOURCE
		{
			name = ElectricCharge
			rate = 0.60
		}
	}

	MODULE
	{
		name = ModuleConductionMultiplier
		modifiedConductionFactor = 0.003
		convectionFluxThreshold = 3000
	}

	MODULE
	{
		name = ModuleLiftingSurface
		useInternalDragModel = False
		deflectionLiftCoeff = 1.4
		liftingSurfaceCurve = CapsuleBottom
		disableBodyLift = False
		omnidirectional = False
		perpendicularOnly = True
		transformDir = Y
		transformSign = -1
		nodeEnabled = True
		attachNodeName = bottom
	}

	//  Comm/System Specific Nodes

	MODULE
	{
		name = ModuleDataTransmitter
		antennaType = INTERNAL
		packetInterval = 1.0
		packetSize = 2
		packetResourceCost = 12.0
		requiredResource = ElectricCharge
		antennaPower = 6400  
		optimumRange = 3200
		packetFloor = .1
		packetCeiling = 5
	}

	//  Science Specific Nodes

	MODULE
	{
		name = ModuleScienceExperiment
		experimentID = crewReport
		experimentActionName = #autoLOC_502009 //#autoLOC_502009 = Crew Report
		resetActionName = #autoLOC_502010 //#autoLOC_502010 = Discard Crew Report
		reviewActionName = #autoLOC_502200 //#autoLOC_502200 = Review Report
		useStaging = False
		useActionGroups = True
		hideUIwhenUnavailable = True
		rerunnable = True
		xmitDataScalar = 1.0
		usageReqMaskInternal = 5
		usageReqMaskExternal = -1
	}

	MODULE
	{
		name = ModuleScienceContainer
		reviewActionName = #autoLOC_502201 //#autoLOC_502201 = Review Stored Data
		storeActionName = #autoLOC_502202 //#autoLOC_502202 = Store Experiments
		evaOnlyStorage = True
		storageRange = 3.0
	}

	// Resource Specific Nodes
	RESOURCE
	{
		name = MonoPropellant
		amount = 40
		maxAmount = 40
	}

	RESOURCE
	{
		name = ElectricCharge
		amount = 250
		maxAmount = 250
	}
}
// Add common mod support features
//
// Moves the command pod in the tech tree if Community Tech Tree is installed
@PART[ArcAero_Wyvern_Capsule]:FOR[ArcAerospace]:NEEDS[CommunityTechTree]
{
	@TechRequired = heavyCommandModules
}
// Add Indicator Lights support.
@PART[ArcAero_Wyvern_Capsule]:FOR[ArcAerospace]:NEEDS[IndicatorLights]
{
// Add crew indicator and flash for crew report available

    //-------------------------------------------------------------------------
    // INDICATOR MESHES
    //-------------------------------------------------------------------------

    MODEL
    {
	model = IndicatorLights/Meshes/nubbinLamp
	scale = 0.7, 0.7, 0.9
	position = -0.28, 0.94, -0.691
	rotation = -15, 205, 0
    }

    MODEL
    {
	model = IndicatorLights/Meshes/nubbinLamp
	scale = 0.7, 0.7, 0.9
	position = -0.285, 0.89, -0.709
	rotation = -15, 205, 0
    }

    MODEL
    {
	model = IndicatorLights/Meshes/nubbinLamp
	scale = 0.7, 0.7, 0.9
	position = -0.29, 0.84, -0.726
	rotation = -15, 205, 0
    }

    MODEL
    {
	model = IndicatorLights/Meshes/nubbinLamp
	scale = 0.7, 0.7, 0.9
	position = -0.295, 0.79, -0.743
	rotation = -15, 205, 0
    }
    MODEL
    {
	model = IndicatorLights/Meshes/nubbinLamp
	scale = 0.7, 0.7, 0.9
	position = -0.30, 0.74, -0.760
	rotation = -15, 205, 0
    }

    //-------------------------------------------------------------------------
    // CONTROLLABLE EMISSIVES
    //-------------------------------------------------------------------------

    MODULE
    {
	name = ModuleControllableEmissive
	target = IndicatorLights/Meshes/nubbinLamp:0
	emissiveName = indicator0
    }

    MODULE
    {
	name = ModuleControllableEmissive
	target = IndicatorLights/Meshes/nubbinLamp:1
	emissiveName = indicator1
    }

    MODULE
    {
	name = ModuleControllableEmissive
	target = IndicatorLights/Meshes/nubbinLamp:2
	emissiveName = indicator2
    }

    MODULE
    {
	name = ModuleControllableEmissive
	target = IndicatorLights/Meshes/nubbinLamp:3
	emissiveName = indicator3
    }
    MODULE
    {
	name = ModuleControllableEmissive
	target = IndicatorLights/Meshes/nubbinLamp:4
	emissiveName = indicator4
    }

    //-------------------------------------------------------------------------
    // CONTROLLERS
    //-------------------------------------------------------------------------

    MODULE
    {
	name = ModuleCrewIndicatorToggle
	toggleName = indicatorToggle
    }
	
    MODULE
    {
	name = ModuleCrewIndicator
	controllerName = crewController0
	toggleName = indicatorToggle
    }

    MODULE
    {
	name = ModuleCrewIndicator
	controllerName = crewController1
	toggleName = indicatorToggle
    }

    MODULE
    {
	name = ModuleCrewIndicator
	controllerName = crewController2
	toggleName = indicatorToggle
    }

    MODULE
    {
	name = ModuleCrewIndicator
	controllerName = crewController3
	toggleName = indicatorToggle
    }

    MODULE
    {
	name = ModuleCrewIndicator
	controllerName = crewController4
	toggleName = indicatorToggle
    }

    MODULE
    {
	name = ModuleScienceAvailabilityIndicator
	controllerName = availability0
	experimentID = crewReport
	lowValueColor = crewController0
	mediumValueColor = highValueColor
	highValueColor = blink(lowValueColor, 200, $Off, 200)
    }

    MODULE
    {
	name = ModuleScienceAvailabilityIndicator
	controllerName = availability1
	experimentID = crewReport
	lowValueColor = crewController1
	mediumValueColor = highValueColor
	highValueColor = blink(lowValueColor, 200, $Off, 200)
    }

    MODULE
    {
	name = ModuleScienceAvailabilityIndicator
	controllerName = availability2
	experimentID = crewReport
	lowValueColor = crewController2
	mediumValueColor = highValueColor
	highValueColor = blink(lowValueColor, 200, $Off, 200)
    }

    MODULE
    {
	name = ModuleScienceAvailabilityIndicator
	controllerName = availability3
	experimentID = crewReport
	lowValueColor = crewController3
	mediumValueColor = highValueColor
	highValueColor = blink(lowValueColor, 200, $Off, 200)
    }
    MODULE
    {
	name = ModuleScienceAvailabilityIndicator
	controllerName = availability4
	experimentID = crewReport
	lowValueColor = crewController4
	mediumValueColor = highValueColor
	highValueColor = blink(lowValueColor, 200, $Off, 200)
    }
    MODULE
    {
	name = ModuleScienceDataIndicator
	experimentID = crewReport
	emissiveName = indicator0
	dataColor = crewController0
	emptyColor = availability0
    }

    MODULE
    {
	name = ModuleScienceDataIndicator
	experimentID = crewReport
	emissiveName = indicator1
	dataColor = crewController1
	emptyColor = availability1
    }

    MODULE
    {
	name = ModuleScienceDataIndicator
	experimentID = crewReport
	emissiveName = indicator2
	dataColor = crewController2
	emptyColor = availability2
    }

    MODULE
    {
	name = ModuleScienceDataIndicator
	experimentID = crewReport
	emissiveName = indicator3
	dataColor = crewController3
	emptyColor = availability3
    }

    MODULE
    {
	name = ModuleScienceDataIndicator
	experimentID = crewReport
	emissiveName = indicator4
	dataColor = crewController4
	emptyColor = availability4
    }

    // This pod uses a ModuleColorChanger to handle its cabin lights, set up
    // so that by default it takes control of *all* emissives on the part.
    // Need to tell it not to tinker with the meshes that we're adding here;
    // otherwise, the crew indicator will just turn on and off with the cabin
    // lights instead of actually working as a crew indicator.
    @MODULE[ModuleColorChanger]
    {
	excludedRenderer = IndicatorLights/Meshes/nubbinLamp(Clone)
    }
}

